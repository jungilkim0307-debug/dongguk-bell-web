<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ììŠµ / ì‹œí—˜ ì›¹ ë²¨</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
   html, body {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
}

body {
  min-height: 100vh;
  background: #101820;
  font-family: "ë§‘ì€ ê³ ë”•", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  color: #ffffff;
  /* ğŸ”¥ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ê²Œ */
  overflow-x: auto;
  overflow-y: auto;
}

.wrapper {
  /* í™”ë©´ì´ ì‘ìœ¼ë©´ ì»¤ì§€ë„ë¡, í¬ë©´ ê°€ìš´ë° ìœ ì§€ */
  min-height: calc(100vh - 40px);
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 8px;
}

    .panel {
      text-align: center;
      padding: 16px 24px;
      min-width: 320px;
      max-width: 900px;
    }
    .row {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 8px 0;
      gap: 12px;
    }
    .label-main {
      flex: 1;
      text-align: center;
      word-break: keep-all;
      white-space: normal;
    }
    .btn-font {
      background: transparent;
      border: none;
      color: #777;
      font-weight: bold;
      font-size: 16px;
      width: 28px;
      height: 28px;
      cursor: pointer;
      border-radius: 4px;
    }
    .btn-font:hover {
      color: #aaa;
    }

    #currentEvent {
      font-weight: 700;
    }
    #clock {
      font-weight: 700;
    }
    #date {
      color: #cccccc;
    }

    .mode-bar {
      margin-top: 6px;
      display: flex;
      justify-content: center;
      gap: 16px;
      font-size: 14px;
      color: #dddddd;
    }
    .mode-bar label {
      cursor: pointer;
    }
    .mode-bar input {
      margin-right: 4px;
    }

    .sound-toggle {
      margin-top: 4px;
      font-size: 14px;
    }
    .sound-toggle button {
      background: transparent;
      border: none;
      color: #bbbbbb;
      cursor: pointer;
      font-size: 14px;
      font-weight: 700;
    }
    .sound-toggle button:hover {
      color: #ffffff;
    }

    .test-controls {
      margin-top: 10px;
      display: none;
      justify-content: center;
      gap: 8px;
    }
    .test-controls button {
      padding: 4px 10px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 13px;
      font-weight: 700;
      background: #1f2933;
      color: #e5e7eb;
    }
    .test-controls button:hover {
      background: #323f4b;
    }

    #testInfo {
      margin-top: 4px;
      font-size: 12px;
      color: #aaaaaa;
    }

    .footer {
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: #666;
    }

    /* ìƒ‰ìƒ */
    .event-study { color: #7CE577; }
    .event-break { color: #E6E675; }
    .event-meal  { color: #FFA500; }
    .event-exam  { color: #FF6B6B; }
    .event-end   { color: #FFFFFF; }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="panel">

      <!-- 1ì¤„: í˜„ì¬ ì´ë²¤íŠ¸ -->
      <div class="row">
        <button class="btn-font" id="eventFontMinus">âˆ’</button>
        <div id="currentEvent" class="label-main">--</div>
        <button class="btn-font" id="eventFontPlus">+</button>
      </div>

      <!-- 2ì¤„: ì‹œê³„ -->
      <div class="row">
        <button class="btn-font" id="clockFontMinus">âˆ’</button>
        <div id="clock" class="label-main">--:--:--</div>
        <button class="btn-font" id="clockFontPlus">+</button>
      </div>

      <!-- 3ì¤„: ë‚ ì§œ -->
      <div class="row">
        <button class="btn-font" id="dateFontMinus">âˆ’</button>
        <div id="date" class="label-main">----.--.--</div>
        <button class="btn-font" id="dateFontPlus">+</button>
      </div>

      <!-- ëª¨ë“œ ì„ íƒ -->
      <div class="mode-bar">
        <label>
          <input type="radio" name="mode" value="real" checked>
          ì‹¤ì œ ëª¨ë“œ
        </label>
        <label>
          <input type="radio" name="mode" value="test">
          í…ŒìŠ¤íŠ¸ ëª¨ë“œ
        </label>
      </div>

      <!-- ì¢…ì†Œë¦¬ ON/OFF -->
      <div class="sound-toggle">
        <button id="soundToggleBtn">ğŸ”” ON</button>
      </div>

      <!-- í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì»¨íŠ¸ë¡¤ -->
      <div class="test-controls" id="testControls">
        <button id="btnPrev">â® ì´ì „</button>
        <button id="btnReplay">ì†Œë¦¬ ë‹¤ì‹œ</button>
        <button id="btnNext">ë‹¤ìŒ â­</button>
      </div>
      <div id="testInfo"></div>

    </div>
  </div>

  <div class="footer">
    * ë¸Œë¼ìš°ì € ë³´ì•ˆ ì •ì±… ë•Œë¬¸ì—, ì²˜ìŒì—ëŠ” í™”ë©´ì„ í•œ ë²ˆ í´ë¦­í•´ì•¼ ì†Œë¦¬ê°€ ë‚˜ì˜¤ê¸° ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  </div>

  <!-- ììŠµ ì‹œì‘/ì¢…ë£Œ ì¢…ì†Œë¦¬ ì˜¤ë””ì˜¤ (íŒŒì¼ì€ ê°™ì€ í´ë”ì— ë‘ê¸°) -->
  <audio id="audioStudyStart" src="start.wav" preload="auto"></audio>
  <audio id="audioStudyEnd"   src="end.wav"   preload="auto"></audio>

  <script>
    // ===== ê³µí†µ ë°ì´í„° =====
    const EVENT_DEFS = [
      ["09:00", "ì˜¤ì „ ììŠµ 1 ì‹œì‘", "study_start"],
      ["10:20", "ì˜¤ì „ ììŠµ 1 ì¢…ë£Œ", "study_end"],
      ["10:40", "ì˜¤ì „ ììŠµ 2 ì‹œì‘", "study_start"],
      ["12:00", "ì˜¤ì „ ììŠµ 2 ì¢…ë£Œ", "study_end"],
      ["12:00", "ê³¼ëª©1 1ì°¨ ì‹œí—˜ ì‹œì‘", "exam_start"],

      ["14:00", "ì˜¤í›„ ììŠµ 1 ì‹œì‘", "study_start"],
      ["15:40", "ì˜¤í›„ ììŠµ 1 ì¢…ë£Œ", "study_end"],
      ["16:00", "ì˜¤í›„ ììŠµ 2 ì‹œì‘", "study_start"],
      ["17:30", "ì˜¤í›„ ììŠµ 2 ì¢…ë£Œ", "study_end"],
      ["17:30", "ê³¼ëª©2 1ì°¨ ì‹œí—˜ ì‹œì‘", "exam_start"],

      ["19:20", "ì €ë… ììŠµ ì‹œì‘", "study_start"],
      ["21:30", "ì €ë… ììŠµ ì¢…ë£Œ", "study_end"],
      ["21:30", "ê³¼ëª©1,2 2ì°¨ ì‹œí—˜ ì‹œì‘", "exam_start"],

      ["22:10", "ì¶”ê°€ ììŠµ ì‹œì‘", "study_start"],
      ["23:10", "ì¶”ê°€ ììŠµ ì¢…ë£Œ", "study_end"],
    ];

    const BLOCK_DEFS = [
      ["09:00", "10:20", "ì˜¤ì „ ììŠµ 1", "study"],
      ["10:20", "10:40", "ì‰¬ëŠ” ì‹œê°„", "break"],
      ["10:40", "12:00", "ì˜¤ì „ ììŠµ 2", "study"],
      ["12:00", "12:20", "ê³¼ëª©1 1ì°¨ ì‹œí—˜", "exam"],
      ["12:20", "14:00", "ì ì‹¬ ì‹œê°„", "meal"],

      ["14:00", "15:40", "ì˜¤í›„ ììŠµ 1", "study"],
      ["15:40", "16:00", "ì‰¬ëŠ” ì‹œê°„", "break"],
      ["16:00", "17:30", "ì˜¤í›„ ììŠµ 2", "study"],
      ["17:30", "18:00", "ê³¼ëª©2 1ì°¨ ì‹œí—˜", "exam"],
      ["18:00", "19:20", "ì €ë… ì‹œê°„", "meal"],

      ["19:20", "21:30", "ì €ë… ììŠµ", "study"],
      ["21:30", "22:00", "ê³¼ëª©1,2 2ì°¨ ì‹œí—˜", "exam"],

      ["22:10", "23:10", "ì¶”ê°€ ììŠµ", "study"],
      ["23:10", "23:20", "ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤ ğŸ‰", "end"],
    ];

    // í…ŒìŠ¤íŠ¸ ëª¨ë“œ ìŠ¤í… (ì¤‘ì²© ì‹œ ììŠµ ì¢…ë£Œ ì†Œë¦¬ëŠ” ì œê±°)
    const TEST_STEPS = [
      ["ì˜¤ì „ ììŠµ 1 ì‹œì‘",        "study", "study_start"],
      ["ì˜¤ì „ ììŠµ 1 ì¢…ë£Œ",        "study", "study_end"],
      ["ì‰¬ëŠ” ì‹œê°„",               "break", null],

      ["ì˜¤ì „ ììŠµ 2 ì‹œì‘",        "study", "study_start"],
      ["ì˜¤ì „ ììŠµ 2 ì¢…ë£Œ",        "study", null],           // 12:00 ì‹œí—˜ê³¼ ì¤‘ì²©
      ["ê³¼ëª©1 1ì°¨ ì‹œí—˜ ì‹œì‘",     "exam",  "exam_start"],
      ["ì ì‹¬ ì‹œê°„",               "meal",  null],

      ["ì˜¤í›„ ììŠµ 1 ì‹œì‘",        "study", "study_start"],
      ["ì˜¤í›„ ììŠµ 1 ì¢…ë£Œ",        "study", "study_end"],
      ["ì‰¬ëŠ” ì‹œê°„",               "break", null],

      ["ì˜¤í›„ ììŠµ 2 ì‹œì‘",        "study", "study_start"],
      ["ì˜¤í›„ ììŠµ 2 ì¢…ë£Œ",        "study", null],           // 17:30 ì‹œí—˜ê³¼ ì¤‘ì²©
      ["ê³¼ëª©2 1ì°¨ ì‹œí—˜ ì‹œì‘",     "exam",  "exam_start"],
      ["ì €ë… ì‹œê°„",               "meal",  null],

      ["ì €ë… ììŠµ ì‹œì‘",          "study", "study_start"],
      ["ì €ë… ììŠµ ì¢…ë£Œ",          "study", null],           // 21:30 ì‹œí—˜ê³¼ ì¤‘ì²©
      ["ê³¼ëª©1,2 2ì°¨ ì‹œí—˜ ì‹œì‘",   "exam",  "exam_start"],

      ["ì¶”ê°€ ììŠµ ì‹œì‘",          "study", "study_start"],
      ["ì¶”ê°€ ììŠµ ì¢…ë£Œ",          "study", "study_end"],
      ["ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤ ğŸ‰",       "end",   null],
    ];

    const PRIORITY = {
      "exam_start": 3,
      "study_start": 2,
      "study_end": 1,
    };

    // ===== ìœ í‹¸: ì˜¤ëŠ˜ ë‚ ì§œì˜ HH:MMì„ Dateë¡œ =====
    function parseTodayTime(hm) {
      const [h, m] = hm.split(":").map(Number);
      const now = new Date();
      return new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m, 0, 0);
    }

    // ===== ì´ë²¤íŠ¸/ë¸”ë¡ ë°ì´í„° ì¤€ë¹„ =====
    const events = EVENT_DEFS.map(([t, msg, kind]) => ({
      timeStr: t,
      time: parseTodayTime(t),
      msg,
      kind,
      done: false,
    }));

    const blocks = BLOCK_DEFS.map(([s, e, name, kind]) => ({
      start: parseTodayTime(s),
      end: parseTodayTime(e),
      name,
      kind,
    }));

    const quitTime = parseTodayTime("23:20");

    // ì‹œì‘ ì‹œ ì´ë¯¸ ì§€ë‚œ ì´ë²¤íŠ¸ëŠ” done ì²˜ë¦¬
    (function markPastEvents() {
      const now = new Date();
      for (const e of events) {
        if (e.time <= now) {
          e.done = true;
        }
      }
    })();

    // ===== DOM ì°¸ì¡° =====
    const currentEventEl = document.getElementById("currentEvent");
    const clockEl = document.getElementById("clock");
    const dateEl = document.getElementById("date");

    const eventMinusBtn = document.getElementById("eventFontMinus");
    const eventPlusBtn = document.getElementById("eventFontPlus");
    const clockMinusBtn = document.getElementById("clockFontMinus");
    const clockPlusBtn = document.getElementById("clockFontPlus");
    const dateMinusBtn = document.getElementById("dateFontMinus");
    const datePlusBtn = document.getElementById("dateFontPlus");

    const soundToggleBtn = document.getElementById("soundToggleBtn");
    const testControls = document.getElementById("testControls");
    const testInfoEl = document.getElementById("testInfo");
    const btnPrev = document.getElementById("btnPrev");
    const btnReplay = document.getElementById("btnReplay");
    const btnNext = document.getElementById("btnNext");

    const modeRadios = document.querySelectorAll('input[name="mode"]');

    const audioStudyStart = document.getElementById("audioStudyStart");
    const audioStudyEnd = document.getElementById("audioStudyEnd");

    // Web Audioë¡œ ì‹œí—˜ ì‹œì‘ ì‚ì†Œë¦¬ ë§Œë“¤ê¸°
    let audioCtx = null;
    function ensureAudioContext() {
      if (!audioCtx) {
        const AC = window.AudioContext || window.webkitAudioContext;
        if (AC) audioCtx = new AC();
      }
    }
    function playExamBeep() {
      if (!audioCtx) return;
      for (let i = 0; i < 3; i++) {
        const startTime = audioCtx.currentTime + i * 0.25;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.frequency.value = 1400;
        gain.gain.setValueAtTime(0.2, startTime);
        gain.gain.exponentialRampToValueAtTime(0.0001, startTime + 0.2);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start(startTime);
        osc.stop(startTime + 0.2);
      }
    }

    // í™”ë©´ ì•„ë¬´ë°ë‚˜ ì²« í´ë¦­í•˜ë©´ ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ ì¤€ë¹„
    window.addEventListener("click", () => {
      ensureAudioContext();
    }, { once: true });

    // ===== ìƒíƒœ =====
    let mode = "real"; // "real" or "test"
    let soundEnabled = true;

    let eventFontSize = 26;
    let clockFontSize = 42;
    let dateFontSize = 14;

    let timerId = null;

    let testIndex = 0;

    // ===== í°íŠ¸ ì ìš© =====
    function applyFontSizes() {
      currentEventEl.style.fontSize = eventFontSize + "px";
      clockEl.style.fontSize = clockFontSize + "px";
      dateEl.style.fontSize = dateFontSize + "px";
    }
    applyFontSizes();

    const MIN_FS = 8;
    const MAX_FS = 120;

    eventMinusBtn.onclick = () => {
      eventFontSize = Math.max(MIN_FS, eventFontSize - 2);
      applyFontSizes();
    };
    eventPlusBtn.onclick = () => {
      eventFontSize = Math.min(MAX_FS, eventFontSize + 2);
      applyFontSizes();
    };
    clockMinusBtn.onclick = () => {
      clockFontSize = Math.max(MIN_FS, clockFontSize - 2);
      applyFontSizes();
    };
    clockPlusBtn.onclick = () => {
      clockFontSize = Math.min(MAX_FS, clockFontSize + 2);
      applyFontSizes();
    };
    dateMinusBtn.onclick = () => {
      dateFontSize = Math.max(MIN_FS, dateFontSize - 1);
      applyFontSizes();
    };
    datePlusBtn.onclick = () => {
      dateFontSize = Math.min(MAX_FS, dateFontSize + 1);
      applyFontSizes();
    };

    // ===== ëª¨ë“œ ì „í™˜ =====
    modeRadios.forEach(r => {
      r.addEventListener("change", () => {
        mode = r.value;
        if (mode === "test") {
          testControls.style.display = "flex";
          testInfoEl.style.display = "block";
          showTestStep(false);
        } else {
          testControls.style.display = "none";
          testInfoEl.style.display = "none";
        }
      });
    });

    // ===== ì‚¬ìš´ë“œ í† ê¸€ =====
    soundToggleBtn.onclick = () => {
      soundEnabled = !soundEnabled;
      if (soundEnabled) {
        soundToggleBtn.textContent = "ğŸ”” ON";
        soundToggleBtn.style.color = "#BBBBBB";
      } else {
        soundToggleBtn.textContent = "ğŸ”• OFF";
        soundToggleBtn.style.color = "#555555";
      }
    };

    // ===== ìƒ‰ìƒ ê²°ì • =====
    function colorClassForKind(kind) {
      switch (kind) {
        case "study": return "event-study";
        case "break": return "event-break";
        case "meal":  return "event-meal";
        case "exam":  return "event-exam";
        case "end":   return "event-end";
        default:      return "";
      }
    }

    // ===== ë¸”ë¡ ì°¾ê¸° =====
    function findBlock(now) {
      for (const b of blocks) {
        if (b.start <= now && now < b.end) {
          return b;
        }
      }
      return null;
    }

    // ===== ì†Œë¦¬ ì¬ìƒ =====
    function playSound(kind) {
      if (!soundEnabled || !kind) return;

      if (kind === "study_start") {
        audioStudyStart.currentTime = 0;
        audioStudyStart.play().catch(() => {});
      } else if (kind === "study_end") {
        audioStudyEnd.currentTime = 0;
        audioStudyEnd.play().catch(() => {});
      } else if (kind === "exam_start") {
        playExamBeep();
      }
    }

    // ===== ì‹¤ì œ ëª¨ë“œ: ì´ë²¤íŠ¸ ì²´í¬ =====
    function checkEvents(now) {
      // pending: ì•„ì§ ì•ˆ ìš¸ë ¸ê³  ì‹œê°„ ì§€ë‚œ ì´ë²¤íŠ¸ë“¤
      const pending = events.filter(e => !e.done && now >= e.time);
      if (pending.length === 0) return;

      const earliestTime = pending.reduce((minT, e) =>
        e.time < minT ? e.time : minT, pending[0].time
      );
      const sameTimeEvents = pending.filter(e => e.time.getTime() === earliestTime.getTime());

      // ìš°ì„ ìˆœìœ„ ê°€ì¥ ë†’ì€ ì´ë²¤íŠ¸ë§Œ ì†Œë¦¬
      let best = sameTimeEvents[0];
      let bestPriority = PRIORITY[best.kind] || 0;
      for (const ev of sameTimeEvents) {
        const p = PRIORITY[ev.kind] || 0;
        if (p > bestPriority) {
          best = ev;
          bestPriority = p;
        }
      }
      playSound(best.kind);

      // ê°™ì€ ì‹œê° ì´ë²¤íŠ¸ëŠ” ëª¨ë‘ done ì²˜ë¦¬
      for (const ev of sameTimeEvents) {
        ev.done = true;
      }
    }

    // ===== í…ŒìŠ¤íŠ¸ ëª¨ë“œ ë¡œì§ =====
    function getCurrentTestStep() {
      return TEST_STEPS[testIndex];
    }

    function showTestStep(play = true) {
      const [name, kind, soundKind] = getCurrentTestStep();
      currentEventEl.textContent = name;
      currentEventEl.className = "label-main " + colorClassForKind(kind);

      let info = `${testIndex + 1} / ${TEST_STEPS.length}   kind=${kind}`;
      if (soundKind) info += `, sound=${soundKind}`;
      else info += ", sound=ì—†ìŒ";
      testInfoEl.textContent = info;

      if (play) {
        playSound(soundKind);
      }
    }

    btnPrev.onclick = () => {
      testIndex = (testIndex - 1 + TEST_STEPS.length) % TEST_STEPS.length;
      showTestStep(true);
    };
    btnNext.onclick = () => {
      testIndex = (testIndex + 1) % TEST_STEPS.length;
      showTestStep(true);
    };
    btnReplay.onclick = () => {
      const [, , soundKind] = getCurrentTestStep();
      playSound(soundKind);
    };

    // ===== ë©”ì¸ íƒ€ì´ë¨¸ ë£¨í”„ =====
    function tick() {
      const now = new Date();

      // ì‹œê³„
      const h = String(now.getHours()).padStart(2, "0");
      const m = String(now.getMinutes()).padStart(2, "0");
      const s = String(now.getSeconds()).padStart(2, "0");
      clockEl.textContent = `${h}:${m}:${s}`;

      const weekdays = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];
      const y = now.getFullYear();
      const mm = String(now.getMonth() + 1).padStart(2, "0");
      const dd = String(now.getDate()).padStart(2, "0");
      const wd = weekdays[now.getDay()];
      dateEl.textContent = `${y}-${mm}-${dd} (${wd})`;

      if (mode === "real") {
        if (now >= quitTime) {
          currentEventEl.textContent = "ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤ ğŸ‰";
          currentEventEl.className = "label-main event-end";
          clearInterval(timerId);
          return;
        }
        const block = findBlock(now);
        if (block) {
          currentEventEl.textContent = block.name;
          currentEventEl.className = "label-main " + colorClassForKind(block.kind);
        } else {
          currentEventEl.textContent = "ì¼ì • ì—†ìŒ";
          currentEventEl.className = "label-main";
        }
        checkEvents(now);
      }

      // í…ŒìŠ¤íŠ¸ ëª¨ë“œì—ì„œëŠ” ì‹œê°„/ë‚ ì§œë§Œ ê°±ì‹ , ì´ë²¤íŠ¸ í…ìŠ¤íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ ìŠ¤í…ì´ ë‹´ë‹¹
    }

    timerId = setInterval(tick, 1000);
    tick(); // ì²˜ìŒ í•œ ë²ˆ ì¦‰ì‹œ ê°±ì‹ 
  </script>
</body>
</html>

